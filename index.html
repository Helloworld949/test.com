<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA Web - Build v1.1.3</title>
    <style>
        :root { --moto: #0078d4; --dark: #121212; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        .window { background: white; width: 95%; max-width: 500px; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: var(--moto); color: white; padding: 15px 20px; font-weight: bold; font-size: 13px; display: flex; justify-content: space-between; }
        .content { padding: 30px; text-align: center; }
        .progress-box { width: 100%; background: #eee; height: 12px; border-radius: 10px; margin: 25px 0 10px; overflow: hidden; display: none; }
        .progress-bar { width: 0%; height: 100%; background: var(--moto); transition: width 0.3s linear; }
        .btn-flash { background: var(--moto); color: white; border: none; padding: 15px 40px; border-radius: 25px; font-weight: bold; cursor: pointer; width: 100%; font-size: 15px; }
        .terminal { background: var(--dark); color: #00ff00; padding: 15px; border-radius: 6px; font-family: 'Consolas', monospace; font-size: 11px; height: 130px; overflow-y: auto; text-align: left; margin-top: 15px; display: none; }
        .ver-info { font-size: 10px; color: #888; margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; }
    </style>
</head>
<body>

<div class="window">
    <div class="header"><span>Rescue and Smart Assistant</span><span>v1.1.3</span></div>
    <div class="content">
        <div id="setup-view">
            <div style="font-size: 50px; margin-bottom: 10px;">üîå</div>
            <h2 style="margin: 0; font-weight: 400;">Resgate de Firmware</h2>
            <p style="color: #666; font-size: 14px;">Inicie o processo para enviar a mensagem Toast de confirma√ß√£o para o dispositivo conectado.</p>
            <button class="btn-flash" onclick="iniciarResgateToast()">EXECUTAR RESGATE</button>
        </div>

        <div id="flash-view" style="display:none;">
            <h2 id="title-status" style="margin:0; font-weight: 400;">Gravando parti√ß√µes...</h2>
            <div class="progress-box" id="p-box" style="display:block;">
                <div class="progress-bar" id="p-bar"></div>
            </div>
            <div id="p-text" style="font-size: 12px; color: var(--moto); font-weight: bold;">0%</div>
            <div class="terminal" id="term" style="display:block;"></div>
        </div>
    </div>
    <div style="text-align: center; padding-bottom: 15px;">
        <div class="ver-info">BUILD: <b>v1.1.3</b> | DEPLOY: 15/01/2026 - 16:30</div>
    </div>
</div>

<script>
    const term = document.getElementById('term');
    const pBar = document.getElementById('p-bar');
    const pText = document.getElementById('p-text');

    function log(msg) {
        term.innerHTML += `> ${msg}<br>`;
        term.scrollTop = term.scrollHeight;
    }

    async function iniciarResgateToast() {
        try {
            const device = await navigator.usb.requestDevice({ filters: [] });
            await device.open();
            
            document.getElementById('setup-view').style.display = 'none';
            document.getElementById('flash-view').style.display = 'block';

            log("Conectado ao " + device.productName);
            log("Sincronizando protocolo ADB...");

            // Simula√ß√£o de etapas
            for (let i = 0; i <= 100; i += 5) {
                pBar.style.width = i + "%";
                pText.innerText = i + "%";
                if(i == 20) log("Enviando bootloader.img...");
                if(i == 50) log("Gravando system partition...");
                if(i == 80) log("Finalizando cache...");
                await new Promise(r => setTimeout(r, 100));
            }

            log("ENVIANDO TOAST PARA O DISPOSITIVO...");
            
            /** * COMANDO TOAST REAL (SIMULADO VIA SHELL)
             * No Android real, o comando via ADB seria: 
             * adb shell "reboot" ou comandos de interface.
             */
            log("COMANDO: am broadcast -a android.intent.action.SHOW_TOAST");
            
            document.getElementById('title-status').innerText = "Sucesso!";
            document.getElementById('title-status').style.color = "green";

            alert("Resgate v1.1.3 conclu√≠do! Verifique a mensagem Toast no Motorola.");

        } catch (e) {
            alert("Erro: Dispositivo n√£o selecionado ou sem permiss√£o.");
        }
    }
</script>

</body>
</html>
